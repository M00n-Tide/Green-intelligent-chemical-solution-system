<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Intelligent Chemistry System</title>
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/element-plus/dist/index.full.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/vue-i18n@9/dist/vue-i18n.global.js"></script>
    <script src="https://unpkg.com/element-plus/dist/locale/en.js"></script>
    <script src="https://unpkg.com/element-plus/dist/locale/zh-cn.js"></script>
    <style>
        .container { padding: 20px; }
        .el-menu { height: 100vh; border-right: none; }
        .content { padding: 20px; }
    </style>
</head>
<body>
    <div id="app">
        <el-container style="height: 100vh;">
            <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
            <el-header style="background-color: #001529; color: white; display: flex; align-items: center; justify-content: space-between; padding: 0 20px;">
                <h1 style="margin: 0; font-size: 20px;">{{ $t('common.systemTitle') }}</h1>
                
                <!-- è¯­è¨€åˆ‡æ¢æŒ‰é’® -->
                <div style="display: flex; align-items: center;">
                    <el-dropdown @command="changeLanguage">
                        <span style="color: white; cursor: pointer; display: flex; align-items: center;">
                            {{ currentLanguage === 'zh-CN' ? 'ğŸ‡¨ğŸ‡³ ä¸­æ–‡' : 'ğŸ‡ºğŸ‡¸ English' }}
                            <el-icon style="margin-left: 5px;"><i class="el-icon-arrow-down"></i></el-icon>
                        </span>
                        <template #dropdown>
                            <el-dropdown-menu>
                                <el-dropdown-item command="zh-CN">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</el-dropdown-item>
                                <el-dropdown-item command="en-US">ğŸ‡ºğŸ‡¸ English</el-dropdown-item>
                            </el-dropdown-menu>
                        </template>
                    </el-dropdown>
                </div>
            </el-header>
            
            <el-container>
                <!-- ä¾§è¾¹æ èœå• -->
                <el-aside width="200px" style="background-color: #001529;">
                    <el-menu :default-active="activeMenu" class="el-menu-vertical-demo" background-color="#001529" text-color="#fff" active-text-color="#ffd04b" @select="handleMenuSelect">
                        <el-menu-item index="1">
                            <el-icon><i class="el-icon-menu"></i></el-icon>
                            <span>{{ $t('menu.chemicalManagement') }}</span>
                        </el-menu-item>
                        <el-menu-item index="2">
                            <el-icon><i class="el-icon-document"></i></el-icon>
                            <span>{{ $t('menu.safetyDataManagement') }}</span>
                        </el-menu-item>
                        <el-menu-item index="3">
                            <el-icon><i class="el-icon-flask"></i></el-icon>
                            <span>{{ $t('menu.experimentManagement') }}</span>
                        </el-menu-item>
                        <el-menu-item index="4">
                            <el-icon><i class="el-icon-warning"></i></el-icon>
                            <span>{{ $t('menu.riskMonitor') }}</span>
                        </el-menu-item>
                    </el-menu>
                </el-aside>

                <!-- ä¸»å†…å®¹åŒº -->
                <el-main class="content">
                    <component :is="currentComponent"></component>
                </el-main>
            </el-container>
        </el-container>
    </div>

    <script>
        const { createApp, ref, reactive, onMounted, watch, useI18n } = Vue;
        const { ElMessage, ElDialog, ElTable, ElTableColumn, ElButton } = ElementPlus;
        const { createI18n } = VueI18n;
        
        // è¯­è¨€èµ„æº
        const messages = {
            'zh-CN': {
                common: {
                    language: 'è¯­è¨€',
                    systemTitle: 'ç»¿è‰²æ™ºèƒ½åŒ–å­¦ç³»ç»Ÿ',
                    switchLanguage: 'åˆ‡æ¢è¯­è¨€',
                    inventory: 'åº“å­˜',
                    operation: 'æ“ä½œ',
                    view: 'æŸ¥çœ‹',
                    status: 'çŠ¶æ€',
                    quantity: 'æ•°é‡',
                    location: 'å­˜å‚¨ä½ç½®'
                },
                menu: {
                    chemicalManagement: 'åŒ–å­¦å“ç®¡ç†',
                    safetyDataManagement: 'å®‰å…¨æ•°æ®ç®¡ç†',
                    experimentManagement: 'å®éªŒç®¡ç†',
                    riskMonitor: 'é£é™©ç›‘æ§'
                },
                chemicalManagement: {
                    title: 'åŒ–å­¦å“ç®¡ç†',
                    addChemical: 'æ–°å¢åŒ–å­¦å“',
                    chemicalName: 'åç§°',
                    casNumber: 'CASå·',
                    hazardLevel: 'å±é™©ç­‰çº§',
                    inventoryInfo: 'åº“å­˜ä¿¡æ¯',
                    inventoryId: 'åº“å­˜ID',
                    loadCatalogError: 'åŠ è½½åŒ–å­¦å“ç›®å½•å¤±è´¥',
                    loadInventoryError: 'åŠ è½½åº“å­˜æ•°æ®å¤±è´¥',
                    addChemicalFeature: 'æ–°å¢åŒ–å­¦å“åŠŸèƒ½å¾…å®ç°',
                    noDanger: 'æ— å±é™©',
                    lowDanger: 'ä½å±',
                    mediumDanger: 'ä¸­å±',
                    highDanger: 'é«˜å±',
                    recordStatus: {
                        enabled: 'å¯ç”¨',
                        disabled: 'åœç”¨',
                        draft: 'è‰ç¨¿'
                    }
                },
                safetyDataManagement: {
                    title: 'å®‰å…¨æ•°æ®ç®¡ç†',
                    search: 'æœç´¢',
                    download: 'ä¸‹è½½',
                    viewDetails: 'æŸ¥çœ‹è¯¦æƒ…',
                    safetyDataSheet: 'å®‰å…¨æ•°æ®è¡¨',
                    emergencyContact: 'ç´§æ€¥è”ç³»äºº',
                    handlingPrecautions: 'æ“ä½œæ³¨æ„äº‹é¡¹',
                    storageConditions: 'å­˜å‚¨æ¡ä»¶',
                    disposalMethod: 'å¤„ç½®æ–¹æ³•',
                    firstAidMeasures: 'æ€¥æ•‘æªæ–½',
                    fireFightingMeasures: 'æ¶ˆé˜²æªæ–½',
                    accidentalReleaseMeasures: 'æ³„æ¼åº”æ€¥å¤„ç†',
                    toxicologicalInformation: 'æ¯’ç†å­¦ä¿¡æ¯',
                    ecologicalInformation: 'ç”Ÿæ€å­¦ä¿¡æ¯',
                    transportInformation: 'è¿è¾“ä¿¡æ¯',
                    regulatoryInformation: 'æ³•è§„ä¿¡æ¯',
                    otherInformation: 'å…¶ä»–ä¿¡æ¯'
                },
                experimentManagement: {
                    title: 'å®éªŒç®¡ç†',
                    createExperiment: 'åˆ›å»ºå®éªŒ',
                    experimentName: 'å®éªŒåç§°',
                    experimentType: 'å®éªŒç±»å‹',
                    startDate: 'å¼€å§‹æ—¥æœŸ',
                    endDate: 'ç»“æŸæ—¥æœŸ',
                    status: 'çŠ¶æ€',
                    participants: 'å‚ä¸äººå‘˜',
                    materials: 'å®éªŒææ–™',
                    equipment: 'å®éªŒè®¾å¤‡',
                    procedures: 'å®éªŒæ­¥éª¤',
                    results: 'å®éªŒç»“æœ',
                    conclusions: 'ç»“è®º',
                    attachments: 'é™„ä»¶',
                    approve: 'æ‰¹å‡†',
                    reject: 'æ‹’ç»',
                    pending: 'å¾…å¤„ç†',
                    inProgress: 'è¿›è¡Œä¸­',
                    completed: 'å·²å®Œæˆ',
                    cancelled: 'å·²å–æ¶ˆ',
                    notes: 'å¤‡æ³¨',
                    riskAssessment: 'é£é™©è¯„ä¼°'
                },
                riskMonitor: {
                    title: 'é£é™©ç›‘æ§',
                    currentRiskLevel: 'å½“å‰é£é™©ç­‰çº§',
                    riskAssessment: 'é£é™©è¯„ä¼°',
                    incidentReport: 'äº‹ä»¶æŠ¥å‘Š',
                    preventiveMeasures: 'é¢„é˜²æªæ–½',
                    emergencyProcedures: 'åº”æ€¥ç¨‹åº',
                    safetyGuidelines: 'å®‰å…¨æŒ‡å—',
                    riskHistory: 'é£é™©å†å²',
                    monitoringDashboard: 'ç›‘æ§ä»ªè¡¨ç›˜',
                    alerts: 'è­¦æŠ¥',
                    notifications: 'é€šçŸ¥',
                    critical: 'ä¸¥é‡',
                    warning: 'è­¦å‘Š',
                    normal: 'æ­£å¸¸',
                    lastUpdated: 'æœ€åæ›´æ–°',
                    viewDetails: 'æŸ¥çœ‹è¯¦æƒ…',
                    generateReport: 'ç”ŸæˆæŠ¥å‘Š',
                    exportData: 'å¯¼å‡ºæ•°æ®',
                    settings: 'è®¾ç½®'
                }
            },
            'en-US': {
                common: {
                    language: 'Language',
                    systemTitle: 'Green Intelligent Chemistry System',
                    switchLanguage: 'Switch Language',
                    inventory: 'Inventory',
                    operation: 'Operation',
                    view: 'View',
                    status: 'Status',
                    quantity: 'Quantity',
                    location: 'Storage Location'
                },
                menu: {
                    chemicalManagement: 'Chemical Management',
                    safetyDataManagement: 'Safety Data Management',
                    experimentManagement: 'Experiment Management',
                    riskMonitor: 'Risk Monitor'
                },
                chemicalManagement: {
                    title: 'Chemical Management',
                    addChemical: 'Add Chemical',
                    chemicalName: 'Name',
                    casNumber: 'CAS Number',
                    hazardLevel: 'Hazard Level',
                    inventoryInfo: 'Inventory Information',
                    inventoryId: 'Inventory ID',
                    loadCatalogError: 'Failed to load chemical catalog',
                    loadInventoryError: 'Failed to load inventory data',
                    addChemicalFeature: 'Add chemical feature to be implemented',
                    noDanger: 'No Danger',
                    lowDanger: 'Low Danger',
                    mediumDanger: 'Medium Danger',
                    highDanger: 'High Danger',
                    recordStatus: {
                        enabled: 'Enabled',
                        disabled: 'Disabled',
                        draft: 'Draft'
                    }
                },
                safetyDataManagement: {
                    title: 'Safety Data Management',
                    search: 'Search',
                    download: 'Download',
                    viewDetails: 'View Details',
                    safetyDataSheet: 'Safety Data Sheet',
                    emergencyContact: 'Emergency Contact',
                    handlingPrecautions: 'Handling Precautions',
                    storageConditions: 'Storage Conditions',
                    disposalMethod: 'Disposal Method',
                    firstAidMeasures: 'First Aid Measures',
                    fireFightingMeasures: 'Fire Fighting Measures',
                    accidentalReleaseMeasures: 'Accidental Release Measures',
                    toxicologicalInformation: 'Toxicological Information',
                    ecologicalInformation: 'Ecological Information',
                    transportInformation: 'Transport Information',
                    regulatoryInformation: 'Regulatory Information',
                    otherInformation: 'Other Information'
                },
                experimentManagement: {
                    title: 'Experiment Management',
                    createExperiment: 'Create Experiment',
                    experimentName: 'Experiment Name',
                    experimentType: 'Experiment Type',
                    startDate: 'Start Date',
                    endDate: 'End Date',
                    status: 'Status',
                    participants: 'Participants',
                    materials: 'Materials',
                    equipment: 'Equipment',
                    procedures: 'Procedures',
                    results: 'Results',
                    conclusions: 'Conclusions',
                    attachments: 'Attachments',
                    approve: 'Approve',
                    reject: 'Reject',
                    pending: 'Pending',
                    inProgress: 'In Progress',
                    completed: 'Completed',
                    cancelled: 'Cancelled',
                    notes: 'Notes',
                    riskAssessment: 'Risk Assessment'
                },
                riskMonitor: {
                    title: 'Risk Monitor',
                    currentRiskLevel: 'Current Risk Level',
                    riskAssessment: 'Risk Assessment',
                    incidentReport: 'Incident Report',
                    preventiveMeasures: 'Preventive Measures',
                    emergencyProcedures: 'Emergency Procedures',
                    safetyGuidelines: 'Safety Guidelines',
                    riskHistory: 'Risk History',
                    monitoringDashboard: 'Monitoring Dashboard',
                    alerts: 'Alerts',
                    notifications: 'Notifications',
                    critical: 'Critical',
                    warning: 'Warning',
                    normal: 'Normal',
                    lastUpdated: 'Last Updated',
                    viewDetails: 'View Details',
                    generateReport: 'Generate Report',
                    exportData: 'Export Data',
                    settings: 'Settings'
                }
            }
        };
        
        // åˆ›å»ºi18nå®ä¾‹
        const i18n = createI18n({
            legacy: false,
            locale: localStorage.getItem('language') || 'zh-CN', // é»˜è®¤ä¸­æ–‡ï¼Œä»æœ¬åœ°å­˜å‚¨è·å–è¯­è¨€è®¾ç½®
            fallbackLocale: 'en-US',
            messages
        });
        
        // è·¯ç”±ç»„ä»¶å®šä¹‰
        const ChemicalManagement = {
            template: `
                <div>
                    <h2>{{ $t('chemicalManagement.title') }}</h2>
                    <el-button type="primary" @click="openAddCatalog">{{ $t('chemicalManagement.addChemical') }}</el-button>
                    <el-table :data="catalogs" border style="width: 100%; margin-top: 20px;">
                        <el-table-column prop="id" label="ID" width="80"></el-table-column>
                        <el-table-column prop="chemicalName" :label="$t('chemicalManagement.chemicalName')"></el-table-column>
                        <el-table-column prop="casNumber" :label="$t('chemicalManagement.casNumber')"></el-table-column>
                        <el-table-column prop="hazardLevel" :label="$t('chemicalManagement.hazardLevel')">
                            <template #default="scope">
                                <span>{{ translateHazardLevel(scope.row.hazardLevel) }}</span>
                            </template>
                        </el-table-column>
                        <el-table-column :label="$t('common.operation')">
                            <template #default="scope">
                                <el-button size="small" @click="viewInventory(scope.row)">{{ $t('common.inventory') }}</el-button>
                            </template>
                        </el-table-column>
                    </el-table>

                    <!-- åº“å­˜å¼¹çª— -->
                    <el-dialog v-model="inventoryDialogVisible" :title="$t('chemicalManagement.inventoryInfo')" width="800px">
                        <el-table :data="inventoryList" border style="width: 100%;">
                            <el-table-column prop="id" :label="$t('chemicalManagement.inventoryId')"></el-table-column>
                            <el-table-column prop="location" :label="$t('common.location')"></el-table-column>
                            <el-table-column prop="quantity" :label="$t('common.quantity')"></el-table-column>
                            <el-table-column prop="status" :label="$t('common.status')"></el-table-column>
                        </el-table>
                    </el-dialog>
                </div>
            `,
            setup() {
                const { t } = useI18n();
                const catalogs = ref([]);
                const inventoryDialogVisible = ref(false);
                const inventoryList = ref([]);

                // ç¿»è¯‘å±é™©ç­‰çº§
                const translateHazardLevel = (level) => {
                    const hazardMap = {
                        'æ— å±é™©': t('chemicalManagement.noDanger'),
                        'ä½å±': t('chemicalManagement.lowDanger'),
                        'ä¸­å±': t('chemicalManagement.mediumDanger'),
                        'é«˜å±': t('chemicalManagement.highDanger'),
                        'No Danger': t('chemicalManagement.noDanger'),
                        'Low Danger': t('chemicalManagement.lowDanger'),
                        'Medium Danger': t('chemicalManagement.mediumDanger'),
                        'High Danger': t('chemicalManagement.highDanger')
                    };
                    return hazardMap[level] || level;
                };

                // ã€å·²ä¿®å¤ã€‘åŠ è½½åŒ–å­¦å“ç›®å½•æ•°æ®
                const loadCatalogs = async () => {
                    try {
                        // å‡è®¾åç«¯æœ‰è·å–æ‰€æœ‰ç›®å½•çš„æ¥å£
                        const res = await axios.get('/api/chemicals/catalogs');
                        catalogs.value = res.data;
                    } catch (err) {
                        ElMessage.error(t('chemicalManagement.loadCatalogError'));
                        console.error(err);
                    }
                };

                // ç»„ä»¶æŒ‚è½½æ—¶åŠ è½½æ•°æ®
                onMounted(loadCatalogs);

                // ã€å·²ä¿®å¤ã€‘å®ç°æŸ¥çœ‹åº“å­˜æ–¹æ³•
                const viewInventory = async (catalog) => {
                    try {
                        const res = await axios.get(`/api/chemicals/inventories?catalogId=${catalog.id}`);
                        inventoryList.value = res.data;
                        inventoryDialogVisible.value = true;
                    } catch (err) {
                        ElMessage.error(t('chemicalManagement.loadInventoryError'));
                        console.error(err);
                    }
                };

                const openAddCatalog = () => {
                    // æ–°å¢åŒ–å­¦å“çš„é€»è¾‘
                    ElMessage.info(t('chemicalManagement.addChemicalFeature'));
                };

                return {
                    catalogs,
                    inventoryDialogVisible,
                    inventoryList,
                    loadCatalogs,
                    viewInventory,
                    openAddCatalog,
                    translateHazardLevel
                };
            }
        };

        const SafetyDataManagement = {
            template: `
                <div>
                    <h2>{{ $t('safetyDataManagement.title') }}</h2>
                    <div style="margin-bottom: 20px;">
                        <el-input :placeholder="$t('safetyDataManagement.search')" style="width: 300px; margin-right: 10px;">
                            <template #prefix>
                                <el-icon><i class="el-icon-search"></i></el-icon>
                            </template>
                        </el-input>
                        <el-button type="primary">{{ $t('safetyDataManagement.search') }}</el-button>
                    </div>
                    
                    <el-table :data="safetyDataList" border style="width: 100%;">
                        <el-table-column prop="chemicalName" :label="$t('chemicalManagement.chemicalName')" width="180"></el-table-column>
                        <el-table-column prop="safetyDataSheet" :label="$t('safetyDataManagement.safetyDataSheet')" width="150">
                            <template #default="scope">
                                <el-button type="text" @click="viewSafetyData(scope.row)">{{ $t('safetyDataManagement.viewDetails') }}</el-button>
                            </template>
                        </el-table-column>
                        <el-table-column prop="emergencyContact" :label="$t('safetyDataManagement.emergencyContact')" width="150"></el-table-column>
                        <el-table-column prop="handlingPrecautions" :label="$t('safetyDataManagement.handlingPrecautions')"></el-table-column>
                        <el-table-column prop="storageConditions" :label="$t('safetyDataManagement.storageConditions')" width="150"></el-table-column>
                        <el-table-column prop="disposalMethod" :label="$t('safetyDataManagement.disposalMethod')" width="150"></el-table-column>
                        <el-table-column :label="$t('common.operation')" width="120">
                            <template #default="scope">
                                <el-button type="text" @click="downloadSafetyData(scope.row)">{{ $t('safetyDataManagement.download') }}</el-button>
                            </template>
                        </el-table-column>
                    </el-table>
                </div>
            `,
            setup() {
                const { t } = useI18n();
                const safetyDataList = ref([
                    {
                        id: 1,
                        chemicalName: 'ä¹™é†‡',
                        safetyDataSheet: 'SDS-001',
                        emergencyContact: 'å¼ åŒ»ç”Ÿ 13800138000',
                        handlingPrecautions: 'é¿å…å¸å…¥è’¸æ°”ï¼Œæˆ´é˜²æŠ¤æ‰‹å¥—',
                        storageConditions: 'é˜´å‡‰å¹²ç‡¥å¤„',
                        disposalMethod: 'åŒ–å­¦åºŸæ¶²å¤„ç†'
                    },
                    {
                        id: 2,
                        chemicalName: 'æ°¢æ°§åŒ–é’ ',
                        safetyDataSheet: 'SDS-002',
                        emergencyContact: 'æåŒ»ç”Ÿ 13900139000',
                        handlingPrecautions: 'é¿å…çš®è‚¤æ¥è§¦ï¼Œæˆ´é˜²æŠ¤çœ¼é•œ',
                        storageConditions: 'å¯†å°å¹²ç‡¥å¤„',
                        disposalMethod: 'ä¸­å’Œåå¤„ç†'
                    }
                ]);
                
                const viewSafetyData = (row) => {
                    ElMessage.info(`${t('safetyDataManagement.viewDetails')}: ${row.chemicalName}`);
                };
                
                const downloadSafetyData = (row) => {
                    ElMessage.info(`${t('safetyDataManagement.download')}: ${row.safetyDataSheet}`);
                };
                
                return {
                    safetyDataList,
                    viewSafetyData,
                    downloadSafetyData
                };
            }
        };

        const ExperimentManagement = {
            template: `
                <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2>{{ $t('experimentManagement.title') }}</h2>
                        <el-button type="primary">{{ $t('experimentManagement.createExperiment') }}</el-button>
                    </div>
                    
                    <el-table :data="experimentList" border style="width: 100%;">
                        <el-table-column prop="name" :label="$t('experimentManagement.experimentName')" width="200"></el-table-column>
                        <el-table-column prop="type" :label="$t('experimentManagement.experimentType')" width="150"></el-table-column>
                        <el-table-column prop="startDate" :label="$t('experimentManagement.startDate')" width="120"></el-table-column>
                        <el-table-column prop="endDate" :label="$t('experimentManagement.endDate')" width="120"></el-table-column>
                        <el-table-column prop="status" :label="$t('experimentManagement.status')" width="120">
                            <template #default="scope">
                                <el-tag :type="getStatusType(scope.row.status)">{{ $t(\`experimentManagement.\${scope.row.status}\`) }}</el-tag>
                            </template>
                        </el-table-column>
                        <el-table-column prop="participants" :label="$t('experimentManagement.participants')" width="150"></el-table-column>
                        <el-table-column prop="riskAssessment" :label="$t('experimentManagement.riskAssessment')" width="120"></el-table-column>
                        <el-table-column :label="$t('common.operation')" width="180">
                            <template #default="scope">
                                <el-button size="small" @click="viewDetails(scope.row)">{{ $t('common.view') }}</el-button>
                                <el-button v-if="scope.row.status === 'pending'" size="small" type="success" @click="approveExperiment(scope.row)">{{ $t('experimentManagement.approve') }}</el-button>
                                <el-button v-if="scope.row.status === 'pending'" size="small" type="danger" @click="rejectExperiment(scope.row)">{{ $t('experimentManagement.reject') }}</el-button>
                            </template>
                        </el-table-column>
                    </el-table>
                </div>
            `,
            setup() {
                const { t } = useI18n();
                const experimentList = ref([
                    {
                        id: 1,
                        name: 'æœ‰æœºåˆæˆå®éªŒ',
                        type: 'æœ‰æœºåŒ–å­¦',
                        startDate: '2023-11-20',
                        endDate: '2023-11-25',
                        status: 'inProgress',
                        participants: 'å¼ ä¸‰, æå››',
                        riskAssessment: 'ä¸­ç­‰é£é™©'
                    },
                    {
                        id: 2,
                        name: 'ææ–™åˆ†æå®éªŒ',
                        type: 'åˆ†æåŒ–å­¦',
                        startDate: '2023-11-22',
                        endDate: '2023-11-24',
                        status: 'pending',
                        participants: 'ç‹äº”',
                        riskAssessment: 'ä½é£é™©'
                    },
                    {
                        id: 3,
                        name: 'å‚¬åŒ–å‰‚æµ‹è¯•',
                        type: 'ç‰©ç†åŒ–å­¦',
                        startDate: '2023-11-15',
                        endDate: '2023-11-18',
                        status: 'completed',
                        participants: 'èµµå…­, é’±ä¸ƒ',
                        riskAssessment: 'é«˜é£é™©'
                    }
                ]);
                
                const getStatusType = (status) => {
                    const statusMap = {
                        'pending': 'info',
                        'inProgress': 'warning',
                        'completed': 'success',
                        'cancelled': 'danger'
                    };
                    return statusMap[status] || 'info';
                };
                
                const viewDetails = (row) => {
                    ElMessage.info(`${t('common.view')}: ${row.name}`);
                };
                
                const approveExperiment = (row) => {
                    ElMessage.success(`${t('experimentManagement.approve')}: ${row.name}`);
                    row.status = 'inProgress';
                };
                
                const rejectExperiment = (row) => {
                    ElMessage.error(`${t('experimentManagement.reject')}: ${row.name}`);
                    row.status = 'cancelled';
                };
                
                return {
                    experimentList,
                    getStatusType,
                    viewDetails,
                    approveExperiment,
                    rejectExperiment
                };
            }
        };

        const RiskMonitor = {
            template: `
                <div>
                    <h2>{{ $t('riskMonitor.title') }}</h2>
                    
                    <!-- é£é™©çº§åˆ«ä»ªè¡¨ç›˜ -->
                    <el-row :gutter="20" style="margin-bottom: 20px;">
                        <el-col :span="8">
                            <el-card shadow="hover">
                                <div style="text-align: center;">
                                    <h3>{{ $t('riskMonitor.currentRiskLevel') }}</h3>
                                    <div style="font-size: 48px; margin: 10px 0;">
                                        <span :style="{ color: getRiskLevelColor(currentRisk.level) }">
                                            {{ $t(\`riskMonitor.\${currentRisk.level}\`) }}
                                        </span>
                                    </div>
                                    <p>{{ $t('riskMonitor.lastUpdated') }}: {{ currentRisk.lastUpdated }}</p>
                                </div>
                            </el-card>
                        </el-col>
                        <el-col :span="16">
                            <el-card shadow="hover">
                                <h3>{{ $t('riskMonitor.monitoringDashboard') }}</h3>
                                <el-row :gutter="10">
                                    <el-col :span="8" v-for="risk in riskSummary" :key="risk.level">
                                        <div :style="{ backgroundColor: getRiskLevelColor(risk.level), padding: '10px', borderRadius: '4px', color: 'white', textAlign: 'center', margin: '5px 0' }">
                                            <div>{{ $t(\`riskMonitor.\${risk.level}\`) }}</div>
                                            <div style="font-size: 24px; font-weight: bold;">{{ risk.count }}</div>
                                        </div>
                                    </el-col>
                                </el-row>
                            </el-card>
                        </el-col>
                    </el-row>
                    
                    <!-- è­¦æŠ¥å’Œé€šçŸ¥ -->
                    <el-row :gutter="20" style="margin-bottom: 20px;">
                        <el-col :span="12">
                            <el-card shadow="hover">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <h3>{{ $t('riskMonitor.alerts') }}</h3>
                                    <el-button size="small">{{ $t('riskMonitor.viewDetails') }}</el-button>
                                </div>
                                <el-timeline>
                                    <el-timeline-item v-for="alert in alerts" :key="alert.id" :type="alert.type" :timestamp="alert.timestamp">
                                        {{ alert.message }}
                                    </el-timeline-item>
                                </el-timeline>
                            </el-card>
                        </el-col>
                        <el-col :span="12">
                            <el-card shadow="hover">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <h3>{{ $t('riskMonitor.notifications') }}</h3>
                                    <el-button size="small">{{ $t('riskMonitor.settings') }}</el-button>
                                </div>
                                <div v-for="notification in notifications" :key="notification.id" style="padding: 10px 0; border-bottom: 1px solid #eee;">
                                    <div>{{ notification.title }}</div>
                                    <div style="font-size: 12px; color: #999;">{{ notification.time }}</div>
                                </div>
                            </el-card>
                        </el-col>
                    </el-row>
                    
                    <!-- æ“ä½œæŒ‰é’® -->
                    <div style="text-align: right; margin-top: 20px;">
                        <el-button>{{ $t('riskMonitor.generateReport') }}</el-button>
                        <el-button type="primary">{{ $t('riskMonitor.exportData') }}</el-button>
                    </div>
                </div>
            `,
            setup() {
                const { t } = useI18n();
                const currentRisk = ref({
                    level: 'normal',
                    lastUpdated: new Date().toLocaleString()
                });
                
                const riskSummary = ref([
                    { level: 'critical', count: 2 },
                    { level: 'warning', count: 5 },
                    { level: 'normal', count: 18 }
                ]);
                
                const alerts = ref([
                    {
                        id: 1,
                        type: 'danger',
                        timestamp: '2023-11-20 10:30',
                        message: 'å®éªŒå®¤Aæ¸©åº¦è¶…è¿‡å®‰å…¨é˜ˆå€¼'
                    },
                    {
                        id: 2,
                        type: 'warning',
                        timestamp: '2023-11-20 09:15',
                        message: 'é€šé£ç³»ç»Ÿéœ€è¦ç»´æŠ¤'
                    }
                ]);
                
                const notifications = ref([
                    {
                        id: 1,
                        title: 'å®‰å…¨æ£€æŸ¥å·²å®Œæˆ',
                        time: '2023-11-20 08:00'
                    },
                    {
                        id: 2,
                        title: 'æ–°å®‰å…¨è§„ç¨‹å·²å‘å¸ƒ',
                        time: '2023-11-19 16:30'
                    }
                ]);
                
                const getRiskLevelColor = (level) => {
                    const colorMap = {
                        'critical': '#F56C6C',
                        'warning': '#E6A23C',
                        'normal': '#67C23A'
                    };
                    return colorMap[level] || '#909399';
                };
                
                return {
                    currentRisk,
                    riskSummary,
                    alerts,
                    notifications,
                    getRiskLevelColor
                };
            }
        };

        // ä¸»åº”ç”¨
        const app = createApp({
            components: {
                ChemicalManagement,
                SafetyDataManagement,
                ExperimentManagement,
                RiskMonitor
            },
            setup() {
                const { t, locale } = useI18n();
                const activeMenu = ref('1');
                const currentComponent = ref('ChemicalManagement');
                const currentLanguage = ref(locale.value);

                // è¯­è¨€åˆ‡æ¢åŠŸèƒ½
                const changeLanguage = (lang) => {
                    locale.value = lang;
                    currentLanguage.value = lang;
                    localStorage.setItem('language', lang); // ä¿å­˜è¯­è¨€åå¥½åˆ°æœ¬åœ°å­˜å‚¨
                };

                // ã€å·²ä¿®å¤ã€‘ç›‘å¬èœå•é€‰æ‹©äº‹ä»¶
                const handleMenuSelect = (key, keyPath) => {
                    switch(key) {
                        case '1':
                            currentComponent.value = 'ChemicalManagement';
                            break;
                        case '2':
                            currentComponent.value = 'SafetyDataManagement';
                            break;
                        case '3':
                            currentComponent.value = 'ExperimentManagement';
                            break;
                        case '4':
                            currentComponent.value = 'RiskMonitor';
                            break;
                        default:
                            currentComponent.value = 'ChemicalManagement';
                    }
                };

                return {
                    activeMenu,
                    currentComponent,
                    currentLanguage,
                    changeLanguage,
                    handleMenuSelect
                };
            }
        });
        
        app.use(ElementPlus);
        app.use(i18n);
        app.mount('#app');
    </script>
</body>
</html>